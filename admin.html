<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Téléphones</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        label, input, select, button {
            display: block;
            margin: 10px 0;
        }
        .brand-container {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <h1>Gestion des Marques et Modèles de Téléphone</h1>
    
    <div id="phone-management">
        <!-- Formulaire pour ajouter/modifier des téléphones -->
        <div class="brand-container">
            <label for="brandSelect">Marque :</label>
            <select id="brandSelect">
                <!-- Rempli dynamiquement avec les marques existantes -->
            </select>
        </div>

        <div class="model-container">
            <label for="modelInput">Modèle :</label>
            <input type="text" id="modelInput" placeholder="Ajouter un nouveau modèle">
        </div>

        <button id="addModelBtn">Ajouter un modèle</button>
        <button id="saveChangesBtn">Sauvegarder les modifications</button>
    </div>

    <script>
        let phonesData = { brands: {} }; // Par défaut vide

        // Fonction pour charger les données existantes de Firestore
        async function loadPhonesData() {
            const docRef = doc(db, 'phones', 'phonesData');
            const docSnap = await getDoc(docRef);

            if (docSnap.exists()) {
                phonesData = docSnap.data();
                const brandSelect = document.getElementById('brandSelect');

                // Remplir la liste des marques
                Object.keys(phonesData.brands).forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand;
                    option.textContent = brand;
                    brandSelect.appendChild(option);
                });
            } else {
                console.log('Aucune donnée trouvée');
            }
        }

        // Ajouter un modèle à la marque sélectionnée
        document.getElementById('addModelBtn').addEventListener('click', function() {
            const selectedBrand = document.getElementById('brandSelect').value;
            const newModel = document.getElementById('modelInput').value;

            if (selectedBrand && newModel) {
                if (!phonesData.brands[selectedBrand]) {
                    phonesData.brands[selectedBrand] = [];
                }
                phonesData.brands[selectedBrand].push(newModel);
                alert('Modèle ajouté avec succès.');
            } else {
                alert('Veuillez sélectionner une marque et entrer un modèle.');
            }
        });

        // Sauvegarder les modifications dans Firestore
        document.getElementById('saveChangesBtn').addEventListener('click', function() {
            savePhoneData(phonesData);
        });

        // Charger les données au démarrage
        loadPhonesData();
    </script>

    <!-- Ajouter Firebase à la page -->
    <script type="module">
       import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
       import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";
    
       const firebaseConfig = {
         apiKey: "AIzaSyAOj_aM10Fcmy7EoVRdgAqXrMBQ1gt081o",
         authDomain: "smart-z-phone-management.firebaseapp.com",
         projectId: "smart-z-phone-management",
         storageBucket: "smart-z-phone-management.appspot.com",
         messagingSenderId: "949078314626",
         appId: "1:949078314626:web:a2a5cb9d87774dc70251b",
         measurementId: "G-KV5WM5J2EX"
       };
    
       // Initialiser Firebase
       const app = initializeApp(firebaseConfig);
       const db = getFirestore(app);
       
       // Fonction pour sauvegarder les données
       async function savePhoneData(data) {
         try {
           await setDoc(doc(db, 'phones', 'phonesData'), data);
           alert('Données sauvegardées avec succès');
         } catch (error) {
           console.error('Erreur lors de la sauvegarde des données :', error);
           alert('Erreur lors de la sauvegarde des données.');
         }
       }
    </script>

</body>
</html>
