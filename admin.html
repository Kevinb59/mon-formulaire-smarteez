<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5 Test - Sélection de téléphone</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        label, select {
            display: block;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Test - Sélection de téléphone</h1>

    <label for="phoneBrand">Marque de téléphone :</label>
    <select id="phoneBrand">
        <option value="">Chargement...</option>
    </select>

    <label for="phoneModel">Modèle de téléphone :</label>
    <select id="phoneModel" disabled>
        <option value="">Sélectionner un modèle</option>
    </select>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAOj_aM10Fcmy7EoVRdgAqXrMBQ1gt081o",
            authDomain: "smart-z-phone-management.firebaseapp.com",
            projectId: "smart-z-phone-management",
            storageBucket: "smart-z-phone-management.appspot.com",
            messagingSenderId: "949078314626",
            appId: "1:949078314626:web:a2a5cb9d87774dc70251b",
            measurementId: "G-KV5WM5J2EX"
        };

        // Initialiser Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Charger les données des marques et modèles
        async function loadPhoneData() {
            try {
                const docRef = doc(db, 'phones', 'phonesData');
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    const data = docSnap.data();
                    populatePhoneBrandSelect(data.brands);
                } else {
                    console.error('Aucune donnée trouvée');
                }
            } catch (error) {
                console.error('Erreur lors de la récupération des données de Firestore:', error);
            }
        }

        // Remplir le select de la marque
        function populatePhoneBrandSelect(brands) {
            const phoneBrandSelect = document.getElementById('phoneBrand');
            const phoneModelSelect = document.getElementById('phoneModel');

            phoneBrandSelect.innerHTML = '<option value="">Sélectionner une marque</option>';

            Object.keys(brands).forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                phoneBrandSelect.appendChild(option);
            });

            // Gérer le changement de marque
            phoneBrandSelect.addEventListener('change', function () {
                const selectedBrand = this.value;
                phoneModelSelect.innerHTML = '<option value="">Sélectionner un modèle</option>';
                phoneModelSelect.disabled = true;

                if (selectedBrand && brands[selectedBrand]) {
                    phoneModelSelect.disabled = false;
                    brands[selectedBrand].forEach(model => {
                        const option = document.createElement('option');
                        option.value = model;
                        option.textContent = model;
                        phoneModelSelect.appendChild(option);
                    });
                }
            });
        }

        // Charger les données au chargement de la page
        loadPhoneData();
    </script>
</body>
</html>
