<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Sélection de téléphone</title>

    <!-- Charger Firebase via des balises script depuis le CDN -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        select {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
        }
    </style>

    <script>
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAOj_aM10Fcmy7EoVRdgAqXrMBQ1gt081o",
            authDomain: "smart-z-phone-management.firebaseapp.com",
            projectId: "smart-z-phone-management",
            storageBucket: "smart-z-phone-management.appspot.com",
            messagingSenderId: "949078314626",
            appId: "1:949078314626:web:a2a5cb9d87774dc70251b",
            measurementId: "G-KV5WM5J2EX"
        };

        // Initialiser Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Charger les données de Firestore
        async function loadPhoneData() {
            try {
                const docRef = db.collection('phones').doc('phonesData');
                const docSnap = await docRef.get();
                if (docSnap.exists) {
                    const data = docSnap.data();
                    populatePhoneBrandSelect(data.brands);
                } else {
                    console.error('Aucune donnée trouvée dans Firestore.');
                }
            } catch (error) {
                console.error('Erreur lors de la récupération des données de Firestore:', error);
            }
        }

        // Remplir le select des marques
        function populatePhoneBrandSelect(brands) {
            const phoneBrandSelect = document.getElementById('phoneBrand');
            const phoneModelSelect = document.getElementById('phoneModel');

            // Vider les options actuelles
            phoneBrandSelect.innerHTML = '<option value="">Sélectionner une marque</option>';
            phoneModelSelect.innerHTML = '<option value="">Sélectionner un modèle</option>';
            phoneModelSelect.disabled = true;

            // Remplir les marques
            Object.keys(brands).forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                phoneBrandSelect.appendChild(option);
            });

            // Gérer le changement de marque
            phoneBrandSelect.addEventListener('change', function() {
                const selectedBrand = this.value;
                phoneModelSelect.innerHTML = '<option value="">Sélectionner un modèle</option>';
                phoneModelSelect.disabled = true;

                if (selectedBrand && brands[selectedBrand]) {
                    phoneModelSelect.disabled = false;
                    brands[selectedBrand].forEach(model => {
                        const option = document.createElement('option');
                        option.value = model;
                        option.textContent = model;
                        phoneModelSelect.appendChild(option);
                    });
                }
            });
        }

        // Charger les données au chargement de la page
        window.onload = loadPhoneData;
    </script>
</head>
<body>

    <h1>Test - Sélection de téléphone</h1>

    <label for="phoneBrand">Marque de téléphone :</label>
    <select id="phoneBrand">
        <option value="">Chargement...</option>
    </select>

    <label for="phoneModel">Modèle de téléphone :</label>
    <select id="phoneModel" disabled>
        <option value="">Sélectionner un modèle</option>
    </select>

</body>
</html>
